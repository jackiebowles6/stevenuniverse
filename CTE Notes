/* 
Today's Topic: CTE
*/
--Common Temporary Expressions: temporary result set, thats used to manipulate a complex subquery data. Only created in memory and not being saved anywhere, instead of a temp table.
-- also called 'with' queries

WITH CTE_employy as 
(SELECT FirstName, LastName, Gender, Salary
, COUNT(gender) OVER (PARTITION by Gender) as TotalGender
, AVG(Salary) OVER (PARTITION BY Gender) as AvgSalary
FROM SQLTutorial...EmployeeDemographics emp
JOIN SQLTutorial...EmployeeSalary sal
	on emp.EmployeeID = sal.EmployeeID
WHERE Salary > '45000'
)
SELECT *
FROM CTE_Employee
